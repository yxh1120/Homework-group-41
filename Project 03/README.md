length extension attack
=

![image]()

**实验简介：**  
首先利用Python实现了简化的sm3算法，通过对随机生成的固定长度的字符串进行sm3加密，然后进行length extension攻击，通过对比扩展前和扩展后的hash值，可验证length extension attack是否成功。

**实验步骤：**  
1.假设已知的哈希摘要为 H(m)，其中 m 是原始输入，摘要长度为 n 位。  
2.选取一个合适的哈希函数扩展方法，例如 Merkle-Damgard 结构，它将输入分成块并进行迭代哈希计算。  
3.通过对已知的 H(m) 进行解析，获取内部状态值，通常是最后一个块的哈希输出或中间状态。  
4.构造一个新的输入块 m’，并设置初始状态为已知的内部状态值。  
5.利用选择的哈希函数扩展方法，使用已知的状态和 m’ 进行迭代哈希计算，生成扩展摘要 H(m || m’)。  
6.H(m || m’) 即为长度扩展攻击成功生成的新摘要。

**基本原理：**  
长度扩展攻击是一种针对哈希函数的攻击方法，它利用了哈希函数的输出长度不足以提供足够安全性的特性。
具体来说，长度扩展攻击在已知哈希摘要 H(m) 的情况下，通过构造合法的输入 m’，使得可以计算出 H(m || m’)，即在不知道 m 的情况下，能够生成与原始摘要相一致的新摘要。
长度扩展攻击的关键在于恢复内部状态值，然后利用已有的状态和追加的消息块生成新摘要。
这种攻击方法利用了一些哈希函数在迭代结构中没有提供消息完整性保护的漏洞。为了防止长度扩展攻击，可以使用具有安全长度的哈希算法，例如SHA-3。
此外，还可以使用HMAC（带有密钥的哈希函数）来增强哈希函数的安全性。

关键代码实现如下：  
![image](https://github.com/yxh1120/Homework-group-41/blob/main/Project%2002/2.png)

测试结果如图所示：  
![image](https://github.com/yxh1120/Homework-group-41/blob/main/Project%2002/1.png)

运行速度：  
可在毫秒级时间内完成对消息的length extension攻击。

实验环境：  
IDLE (Python 3.10 64-bit)

